<div class="department-selector">
  <h3 class="section-title">Abteilung</h3>
  <p class="section-subtitle">Wähle eine Abteilung für bessere Organisation</p>
  
  <div class="department-grid">
    <!-- No Department Option -->
    <mat-card 
      class="department-card"
      [class.selected]="selectedDepartmentId === null"
      (click)="selectDepartment(null)">
      <mat-card-content>
        <div class="department-content">
          <div class="department-icon">
            <span class="no-department-icon">❓</span>
          </div>
          <div class="department-info">
            <div class="department-name">Keine Abteilung</div>
          </div>
          <div class="check-icon" *ngIf="selectedDepartmentId === null">
            <mat-icon>check</mat-icon>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Department Options -->
    <mat-card 
      *ngFor="let department of departments$ | async" 
      class="department-card"
      [class.selected]="selectedDepartmentId === department.id"
      (click)="selectDepartment(department.id)">
      <mat-card-content>
        <div class="department-content">
          <div class="department-icon">
            <img 
              [src]="getIconPath(department.icon)" 
              [alt]="department.nameGerman"
              onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
            <span class="fallback-icon" style="display: none;">📦</span>
          </div>
          <div class="department-info">
            <div class="department-name">{{ department.nameGerman }}</div>
          </div>
          <div class="check-icon" *ngIf="selectedDepartmentId === department.id">
            <mat-icon>check</mat-icon>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>